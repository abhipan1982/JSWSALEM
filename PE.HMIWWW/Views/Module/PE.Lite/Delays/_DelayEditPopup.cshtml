@model PE.HMIWWW.ViewModel.Module.Lite.Delay.VM_Delay
@{
  Layout = "~/Views/Shared/_PopupLayout.cshtml";
}

<form asp-controller="Delays" asp-action="UpdateDelay" data-ajax="true" data-ajax-method="POST"
      data-ajax-begin="OnFormBegin" data-ajax-success="OnFormSuccess" data-ajax-failure="OnFormError"
      class="container-fluid" target="formContainer" role="form" id="form">

  @Html.AntiForgeryToken()
  @Html.HiddenFor(x => x.Id)
  @Html.HiddenFor(x => x.IsPlanned)

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.EventStartTs)</label>
    </div>
    <div class="col-7">
      @Html.Kendo().DateTimePickerFor(x => x.EventStartTs).Format(VM_Resources.GLOB_LongDateTime_FORMAT_Picker).HtmlAttributes(new { @class = "form-control form-control-sm" })
      @Html.ValidationMessageFor(x => x.EventStartTs)
    </div>
  </div>

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.EventEndTs)</label>
    </div>
    <div class="col-7">
      @Html.Kendo().DateTimePickerFor(x => x.EventEndTs).Format(VM_Resources.GLOB_LongDateTime_FORMAT_Picker).HtmlAttributes(new { @class = "form-control form-control-sm" })
      @Html.ValidationMessageFor(x => x.EventEndTs)

    </div>
  </div>

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.CatalogueCategoryName)</label>
    </div>
    <div class="col-7">
      @(Html.Kendo().DropDownListFor(x => x.CatalogueCategoryId)
        .DataTextField("Text")
        .DataValueField("Value")
        .Events(events => events.Select("_Delay_EditPopup.onEventCataloguCategorySelect"))
        .HtmlAttributes(new { @class = "form-control form-control-sm", style = "width: 210px" })
        .BindTo(new SelectList(@ViewBag.CategoryList, "Id", "EventCatalogueCategoryName"))
        .OptionLabel("-")
        )
    </div>
  </div>

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.DelayCatalogueName)</label>
    </div>
    <div class="col-7">
      @(Html.Kendo().DropDownListFor(x => x.FkEventCatalogueId)
                .DataTextField("EventCatalogueName")
                .DataValueField("Id")
                .HtmlAttributes(new {@class = "form-control form-control-sm", style = "width: 210px"})
                .DataSource(source => { source.Read(read => { read.Action("FilterEventCatalogue", "Delays").Data("_Delay_EditPopup.getEventCatalogueFilter"); }).ServerFiltering(true); })
                )
    </div>
  </div>

  <div class="row form-group">
    <div class="col-5 text-right align-self-center">
      <label>@Html.LabelFor(x => x.DelayAssetName)</label>
    </div>
    <div class="col-7">
      @(Html.Kendo().DropDownListFor(x => x.FkAssetId)
              .DataTextField("Text")
              .DataValueField("Value")
              .HtmlAttributes(new {@class = "form-control form-control-sm"})
              .BindTo(new SelectList(ViewBag.AssetList, "AssetId", "AssetName"))
              .OptionLabel("-")
            )
    </div>
  </div>

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.WorkOrderName)</label>
    </div>
    <div class="col-7">
      @(Html.Kendo().DropDownListFor(x => x.FkWorkOrderId)
                .DataTextField("Text")
                .DataValueField("Value")
                .HtmlAttributes(new {@class = "form-control form-control-sm", style = "width: 210px"})
                .BindTo(new SelectList(ViewBag.WorkOrdersList, "WorkOrderId", "WorkOrderName"))
                .OptionLabel("-"))
    </div>
  </div>

  <div class="row form-group">
    <div class="col text-right align-self-center">
      <label>@Html.LabelFor(x => x.UserComment)</label>
    </div>
    <div class="col-7">
      @Html.TextAreaFor(x => x.UserComment, new { @class = "form-control k-textbox", style = "width: 210px", rows = 10 })
    </div>
  </div>

  <hr />

  <div class="row form-group">
    <div class="col text-right">
      <button class="btn btn-primary popup_button" type="submit">
        @VM_Resources.GLOB_Form_Button_Update
      </button>
    </div>
  </div>
</form>

<script>
  $(function () {
    $("#form").kendoValidator().data("kendoValidator");
  });
</script>
