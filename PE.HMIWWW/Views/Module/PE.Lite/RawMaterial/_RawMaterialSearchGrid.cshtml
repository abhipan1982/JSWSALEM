@using PE.HMIWWW.ViewModel.Module.Lite.Material

@(
    Html.Kendo().Grid<VM_RawMaterialsTree>()
        .Name("SearchGrid")
        .NoRecords(x => x.Template(VM_Resources.GLOB_GRID_NO_DATA))
        .Pageable(p => p
            .Refresh(true)
            .Messages(m => m.Display(VM_Resources.GLOB_pagination))
            .PageSizes(true))
        .Sortable()
        .Filterable()
        .Selectable()
        .HtmlAttributes(new {style = string.Format("height:{0}px;", ViewBag.FullGridHeight)})
        .Columns(columns =>
        {
            columns.Bound(c => c.RawMaterialId).Visible(false);
            columns.Bound(c => c.MaterialIsAssigned).Visible(false);
            columns.Bound(c => c.DisplayedMaterialName).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RawMaterialCreatedTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RawMaterialStartTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RawMaterialEndTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RollingStartTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RollingEndTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.ProductCreatedTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).Hidden(true).HtmlAttributes(new {@class = "nowrap"});
            columns.ForeignKey(o => o.EnumRawMaterialStatus, (SelectList) ViewBag.RawMaterialStatuses);
        })
        .ToolBar(toolbar => toolbar.ClientTemplateId("SearchGridToolbarTemplate"))
        .DataSource(d => d
            .Ajax()
            .ServerOperation(true)
            .PageSize(26)
            .Sort(sort =>
            {
                sort.Add(s => s.RootRawMaterialId).Descending();
                sort.Add(s => s.RawMaterialId).Ascending();
            })
            .Read(r => r.Action("GetRawMaterialSearchList", "RawMaterial"))
        )
        .Events(e =>
        {
          e.Change("onElementSelect");
          e.DataBound("colorEmptyL3MaterialAndSelectRow");
        })
)
