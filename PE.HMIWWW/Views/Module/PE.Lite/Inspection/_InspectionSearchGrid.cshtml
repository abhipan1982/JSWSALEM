@using PE.HMIWWW.ViewModel.Module.Lite.QualityInspection

@(
    Html.Kendo()
        .Grid<VM_QualityInspection>()
        .Name("SearchGrid")
        .NoRecords(n => n.Template(VM_Resources.GLOB_GRID_NO_DATA))
        .Pageable(p => p
            .Messages(m => m.Display(VM_Resources.GLOB_pagination)))
        .Sortable()
        .Filterable()
        .Selectable()
        .Events(e => e.DataBound("selectRow"))
        .HtmlAttributes(new {style = "height: 735px;"})
        .Columns(columns =>
        {
            columns.Bound(c => c.RawMaterialId).Visible(false);
            columns.Bound(x => x.RawMaterialName).HtmlAttributes(new { @class = "nowrap" });
            columns.Bound(c => c.HasDefects).ClientTemplate(
              "<img src='" + "#=HasDefectImageSRC#".BuildImageSrc() + "' /> #=HasDefectsText#").Width(40);
            columns.ForeignKey(o => o.EnumInspectionResult, (SelectList)ViewBag.InspectionResultList).ClientTemplate(
              "<img src='" + "#=InspectionResultImageSRC#".BuildImageSrc() + "' /> #=InspectionResultText#").Width(95);
            columns.Bound(x => x.WorkOrderName).Hidden(true).HtmlAttributes(new { @class = "nowrap" });
            columns.Bound(x => x.HeatName).Hidden(true).HtmlAttributes(new { @class = "nowrap" });
            columns.Bound(c => c.MaterialCreatedTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.MaterialStartTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.MaterialEndTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.ProductCreatedTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RollingStartTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
            columns.Bound(c => c.RollingEndTs).Filterable(f => f.UI(GridFilterUIRole.DateTimePicker)).Hidden(true).Format(VM_Resources.ResourceManager.GetString("GLOB_LongDateTime_FORMAT")).HtmlAttributes(new {@class = "nowrap"});
        })
        .ToolBar(toolbar => toolbar.ClientTemplateId("SearchGridToolbarTemplate"))
        .DataSource(d => d
            .Ajax()
            .ServerOperation(true)
            .Filter(f => f.Add(a => a.EnumInspectionResult).IsEqualTo(3))
            .PageSize(26)
            .Sort(sort => sort.Add(s => s.RawMaterialId).Descending())
            .Read(r => r.Action("GetRawMaterialSearchList", "Inspection"))
            .Events(e => e.Change("dataSourceChange"))
        )
        .Events(e => e.Change("onElementSelect"))
)
